# Миграция данных

## SwiftData миграции

При добавлении новых полей или моделей в SwiftData необходимо обеспечить мягкую миграцию данных.

### Добавление новых моделей

При создании новой модели SwiftData:

1. **Добавить модель в схему** в `SwiftUI_SotkaAppApp.swift`:

   ```swift
   let schema = Schema(
       [
           User.self,
           Country.self,
           CustomExercise.self,
           UserProgress.self,
           DayActivity.self,
           DayActivityTraining.self,
           SyncJournalEntry.self  // Новая модель
       ]
   )
   ```

2. **Обновить схему в PreviewModelContainer** для превью

### Добавление новых полей

При добавлении новых полей в существующую модель SwiftData:

1. **Новые поля имеют значения по умолчанию** в объявлении модели:

   ```swift
   var newField: String = ""
   var newOptionalField: Int? = nil
   var newBoolField: Bool = false
   ```

2. **Инициализаторы устанавливают правильные значения**:
   - Для новых объектов устанавливаются значения по умолчанию
   - Для существующих объектов SwiftData автоматически применяет значения по умолчанию

3. **SwiftData автоматически обрабатывает миграцию** при первом запуске после обновления модели

### Проверка миграции

После обновления модели рекомендуется:

1. Запустить приложение в симуляторе
2. Проверить, что существующие данные сохранились
3. Убедиться, что новые поля имеют корректные значения по умолчанию
4. Протестировать создание новых объектов

### Общие принципы миграции

- Все новые модели должны быть явно добавлены в схему `Schema`
- Все новые поля должны иметь значения по умолчанию
- Инициализаторы должны корректно устанавливать значения для разных сценариев создания объектов
- Тестирование миграции обязательно перед релизом
- При сложных изменениях схемы может потребоваться ручная миграция через `ModelContainer` с кастомными миграциями
