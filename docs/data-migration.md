# Миграция данных

## SwiftData миграции

При добавлении новых полей в модели SwiftData необходимо обеспечить мягкую миграцию данных.

### Пример миграции для CustomExercise

При добавлении полей `isSynced`, `shouldDelete`, `usageCount` в модель `CustomExercise`:

1. **Новые поля имеют значения по умолчанию** в объявлении модели:
   ```swift
   var isSynced: Bool = false
   var shouldDelete: Bool = false  
   var usageCount: Int = 0
   ```

2. **Инициализаторы устанавливают правильные значения**:
   - Для новых локальных объектов: `isSynced = false`, `shouldDelete = false`, `usageCount = 0`
   - Для объектов с сервера: `isSynced = true`, `shouldDelete = false`

3. **SwiftData автоматически обрабатывает миграцию** при первом запуске после обновления модели

### Проверка миграции

После обновления модели рекомендуется:
1. Запустить приложение в симуляторе
2. Проверить, что существующие данные сохранились
3. Убедиться, что новые поля имеют корректные значения по умолчанию
4. Протестировать создание новых объектов

### Общие принципы миграции

- Все новые поля должны иметь значения по умолчанию
- Инициализаторы должны корректно устанавливать значения для разных сценариев создания объектов
- Тестирование миграции обязательно перед релизом
- При сложных изменениях схемы может потребоваться ручная миграция через `ModelContainer` с кастомными миграциями
